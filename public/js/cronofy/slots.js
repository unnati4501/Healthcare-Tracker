!function(e){var t={};function i(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(a,o,function(t){return e[t]}.bind(null,o));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=145)}({145:function(e,t,i){e.exports=i("g4JU")},g4JU:function(e,t){function a(e,t){$(e).timepicker({showDuration:!0,timeFormat:"h:i A",step:30,useSelect:!0})}function o(e,t){$(".location_ws_column").hide(),$(".location_WS_specific_edit").addClass("d-none"),$(".location_ws_column_test").addClass("d-none");var i=$("#dt_wellbeing_sp_ids").val();1==e&&1==t?$("#set_business_hours").show():1==e&&2==t&&i.length>0?$("#set_wellbeing_hours").show():2==e&&1==t?($(".location_ws_column, .slot-specific, .slot-calendar-general, .slot-calendar-specific").hide(),$(".location_WS_specific_edit").removeClass("d-none"),$("#set_location_hours, .slot-general").show()):2==e&&2==t&&($(".location_ws_column, .slot-specific, .slot-calendar-specific, #set_location_hours").show(),$(".location_ws_column_test").removeClass("d-none"),$(".location_WS_specific_edit").addClass("d-none"),$(".slot-general, .slot-calendar-general").hide())}$(document).ready((function(){$(document).on("click",".add-slot",(function(e){var t=$("#dt_wellbeing_sp_ids").val();if(t.length<=0)return toastr.error("Staff field is required."),!0;if(0==$(this).parents(".slots-wrapper").find(".add-new-slot-block").length){var i=$("#add-new-slot-template").text().trim();$(this).parents(".slots-wrapper").append(i);var o=$(this).parents(".slots-wrapper").find(".slot-control-block");a(o.find(".time")),$(".dt_wb_ids").empty(),$.each(JSON.parse(wellbeingSpecialist),(function(e,i){$.inArray(e,t)>=0&&$(".dt_wb_ids").append('<option value="'+e+'">'+i+"</option>")})),setTimeout((function(){var e=$(".dt_wb_ids").select2({closeOnSelect:!1}).on("change",(function(t){e.select2("close"),e.select2("open")}))}),100)}})),$(document).on("click",".save-new-slot",(function(e){var t=$(this).parents(".add-new-slot-block").find(".slot-control-block");$(".toast").remove();var a=$("#preview-slot-template").text().trim(),o=$("#preview-ws-slot-template").text().trim(),n=$("#preview-ws-hidden-template").text().trim(),s=$(this).parents(".set-availability-box").data("dayKey")||"",l=$(this).parents(".slots-wrapper"),r=$(this).parents(".slot-action-block"),c=t.find(".time"),d=moment($(c[0]).timepicker("getTime")),p=moment($(c[1]).timepicker("getTime")),m=!0,f=l.find('.preview-slot-block input[name*="slots"]').serializeArray(),_=moment(d).format("HH:mm"),u=moment(p).format("HH:mm");if("00:00"!=_&&"00:00"!=u&&d>=p)return m=!1,toastr.error("Please select appropriate time slots"),!1;if(f.length>0){var v=f.map((function(e){return moment(new Date("".concat(today.getFullYear(),"-").concat(today.getMonth()+1,"-").concat(today.getDate()," ").concat(e.value)))}));for(i=0;i<v.length;i++)if(i%2==0&&(v[i].isBetween(d,p,void 0,"[)")||v[i+1].isBetween(d,p,void 0,"(]")||d.isBetween(v[i],v[i+1],void 0,"[)")||p.isBetween(v[i],v[i+1],void 0,"(]"))){m=!1,toastr.error("Selected duration is occupied.");break}}if(m){var w=$("#dt_wb_ids").val(),g="",h="",b="id".concat(Date.now()),y=1;$.each(JSON.parse(wellbeingSpecialist),(function(e,t){var i="";if($.inArray(e,w)>=0){if(y<w.length)i=", ";g+=o.replace(/\#value#/g,e).replace(/\#key#/g,s).replace(/\#id#/g,b).replace(/\#ws_name#/g,t)+i,h+=n.replace(/\#value#/g,e).replace(/\#key#/g,s).replace(/\#id#/g,b).replace(/\#ws_name#/g,t),y++}})),l.find(".no-data-block").addClass("d-none");var k=p.format("HH:mm");a=a.replace(/\#key#/g,s).replace(/\#start_time#/g,d.format("HH:mm")).replace(/\#end_time#/g,k).replace("#time#","".concat(d.format("hh:mm A")," - ").concat(p.format("hh:mm A"))).replace(/\#id#/g,b).replace(/\#ws_selected#/g,g).replace(/\#ws_hidden_fields#/g,h),r.find(".close-add-new-slot").trigger("click"),l.append(a),$("#slots_exist").val("1").valid()}})),$(document).on("click",".close-add-new-slot",(function(e){$(this).parents(".add-new-slot-block").remove()})),$(document).on("click",".remove-slot",(function(e){$("#remove-slot-model-box").data("selector",$(this)).modal("show")})),$(document).on("hidden.bs.modal","#remove-slot-model-box",(function(e){$("#remove-slot-model-box").data("selector",void 0)})),$("#remove-slot-confirm").on("click",(function(e){var t=$("#remove-slot-model-box").data("selector")||void 0;if(t){var i=$(t).parents(".preview-slot-block"),a=i.parents(".slots-wrapper");a.find(".preview-slot-block").length-1==0&&(a.find(".no-data-block").removeClass("d-none"),1==$(".set-availability-block").find(".preview-slot-block").length&&$("#slots_exist").val("").valid()),i.remove(),$("#remove-slot-model-box").modal("hide")}})),$(document).on("click",".edit-slot",(function(e){var t=$("#dt_wellbeing_sp_ids").val();if(t.length<=0)return toastr.error("Staff field is required."),!0;var i=$(this).parents(".preview-slot-block"),o=i.parents(".slots-wrapper"),n=o.find(".add-new-slot-block"),s=o.find(".edit-slot-block"),l=i.find(".start-time-data").val()||0,r=i.find(".end-time-data").val()||0,c=$(this).parents(".preview-slot-block").data("id");if(l&&r){l=new Date("".concat(today.getFullYear(),"-").concat(today.getMonth()+1,"-").concat(today.getDate()," ").concat(l)),r=new Date("".concat(today.getFullYear(),"-").concat(today.getMonth()+1,"-").concat(today.getDate()," ").concat(r)),s.length>0&&s.find(".cancel-edit-slot").trigger("click"),n.length>0&&n.find(".close-add-new-slot").trigger("click");var d=$("#edit-slot-template").text().trim();d=d.replace("#id#",0).replace("#start_time#",l).replace("#end_time#",r),$(d).insertAfter(i),i.addClass("d-none");var p=$(this).parents(".slots-wrapper").find(".slot-control-block"),m=p.find(".time");a(m),$(m[0]).timepicker("setTime",l),$(m[1]).timepicker("setTime",r);var f=[];i.find(".selected_ws").length&&i.find(".selected_ws").each((function(e,t){f.push(this.value)})),o.find(".edit-slot-block").attr("data-id",c),$(".dt_wb_ids").empty(),$.each(JSON.parse(wellbeingSpecialist),(function(e,i){if($.inArray(e,t)>=0){var a="";$.inArray(e,f)>=0&&(a="selected='selected'"),$(".dt_wb_ids").append('<option value="'+e+'" '+a+">"+i+"</option>")}})),setTimeout((function(){var e=$(".dt_wb_ids").select2({closeOnSelect:!1}).on("change",(function(t){e.select2("close"),e.select2("open")}))}),200)}})),$(document).on("click",".save-edit-slot",(function(e){var t=$(this).parents(".edit-slot-block"),a=$(this).parents(".slots-wrapper"),o=$("#preview-ws-slot-template").text().trim(),n=$("#preview-ws-hidden-template").text().trim(),s=$(this).parents(".set-availability-box").data("dayKey")||"";t.find(".slot-control-block");$(".toast").remove();var l=t.prev(),r=t.find(".time"),c=moment($(r[0]).timepicker("getTime")),d=moment($(r[1]).timepicker("getTime")),p=!0,m=a.find(".preview-slot-block").not(l).find('input[name*="slots"]').serializeArray(),f=$(this).parents(".edit-slot-block").data("id"),_=moment(c).format("HH:mm"),u=moment(d).format("HH:mm");if("00:00"!=_&&"00:00"!=u&&c>=d)return addNewSlot=!1,toastr.error("Please select appropriate time slots"),!1;if(m.length>0){var v=m.map((function(e){return moment(new Date("".concat(today.getFullYear(),"-").concat(today.getMonth()+1,"-").concat(today.getDate()," ").concat(e.value)))}));for(i=0;i<v.length;i++)if(i%2==0&&(v[i].isBetween(c,d,void 0,"[)")||v[i+1].isBetween(c,d,void 0,"(]")||c.isBetween(v[i],v[i+1],void 0,"[)")||d.isBetween(v[i],v[i+1],void 0,"(]"))){p=!1,toastr.error("Selected duration is occupied.");break}}if(p){var w=$("#dt_wb_ids").val(),g="",h="",b=1;$.each(JSON.parse(wellbeingSpecialist),(function(e,t){var i="";if($.inArray(e,w)>=0){if(b<w.length)i=", ";g+=o.replace(/\#value#/g,e).replace(/\#key#/g,s).replace(/\#id#/g,f).replace(/\#ws_name#/g,t)+i,h+=n.replace(/\#value#/g,e).replace(/\#key#/g,s).replace(/\#id#/g,f).replace(/\#ws_name#/g,t),b++}})),l.removeClass("d-none"),l.find(".slot-timmings").html("".concat(c.format("hh:mm A")," - ").concat(d.format("hh:mm A"))),l.find(".start-time-data").val(c.format("HH:mm")),l.find(".end-time-data").val(d.format("HH:mm")),l.find(".ws_selected_users").html(g),l.find(".ws_hidden_fields").html(h),t.remove()}})),$(document).on("click",".cancel-edit-slot",(function(e){var t=$(this).parents(".edit-slot-block");t.prev().removeClass("d-none"),t.remove()})),$(".set_hours").hide(),o(hoursby,availabilityby),$("#set_hours_by, #set_availability_by").change((function(){$(".set_hours").hide(),o($("#set_hours_by").val(),$("#set_availability_by").val())})),$(document).on("click",".edit-location-specific",(function(){var e=$("#dt_wellbeing_sp_ids :selected").map((function(e,t){return $(t).val()+"-"+$(t).text()})).get();$("#location_specific_wellbeing_sp_ids").empty(),$.each(e,(function(e,t){var i=t.split("-");$("#location_specific_wellbeing_sp_ids").append('<option value="'+i[0]+'" selected>'+i[1]+"</option>")})),$("#location_specific_wellbeing_sp_ids").trigger("change select2");$(".edit-location-specific").parent("tr").find("td:first").text();var t=$(this).attr("locationid"),i=$.parseJSON(locationList).find((function(e){if(e.id==t)return e}));$("#location-specific-ws-slot").find("#modal_title").html(i.name+"'s Availability"),$("#location-specific-ws-slot").attr("data-id",t).modal("show"),$("#location_specific_wellbeing_sp_ids").attr("data-id",t);var a=[],o="";$("#dtspecificwshours").find("tbody").html(""),$("#location_ws_id_"+t+" > span").map((function(){var e=this.id.split("_"),t=e[e.length-1],i=this.title;""!=i&&(o+='<tr id="ws_'+t+'" data-type="new"><td>'+i+"</td>",o+="<td class='text-center'>",o+="<a class='action-icon bs-calendar-slidebar' id="+t+" href='javascript:;' data-toggle='canvas' data-target='#bs-canvas-right' aria-expanded='false' aria-controls='bs-canvas-right' title='Edit'>",o+="<i class='far fa-edit'></i></a></td></tr>",a.push(t))})),$("#dtspecificwshours").find("tbody").html(o),$(".location_specific_wellbeing_sp_ids").val(a).prop("selected",!0).trigger("change.select2"),0==$("#location-specific-ws-slot").attr("data-id",t).find("table > tbody > tr").length&&$("#location-specific-ws-slot").attr("data-id",t).find("table > tbody").html('<tr class="text-center no-tr-'+t+'" ><td>No wellbeing specialist available</td></tr>')})),$(document).on("select2:unselect",".location_specific_wellbeing_sp_ids",(function(e){var t=$(this).attr("data-id"),i=e.params.data.id;$("#dtspecificwshours").find("#ws_"+i).remove(),$(".ls_slots_"+t+"_"+i).remove(),$(".location_ws_column").find("#ws_"+t+"_"+i).remove(),0==$("#location-specific-ws-slot").attr("data-id",t).find("table > tbody > tr").length&&$("#location-specific-ws-slot").attr("data-id",t).find("table > tbody").html('<tr class="text-center no-tr-'+t+'"><td>No wellbeing specialist available</td></tr>')})),$(document).on("select2:select",".location_specific_wellbeing_sp_ids",(function(e){var t=$(this).attr("data-id"),i=e.params.data.id,a=e.params.data.text;specificHtml='<tr id="ws_'+i+'" data-type="new"><td>'+a+"</td>",specificHtml+="<td class='text-center'>",specificHtml+="<a class='action-icon bs-calendar-slidebar' id="+i+" href='javascript:;' data-toggle='canvas' data-target='#bs-canvas-right' aria-expanded='false' aria-controls='bs-canvas-right' title='Edit'>",specificHtml+="<i class='far fa-edit'></i></a></td></tr>";var o="<span id='ws_"+t+"_"+i+"' title='"+a+"' class='ws_sl_"+t+" ws_"+i+" badge badge-secondary'>"+a+"</span>";$("table#dtspecificwshours tr.no-tr-"+t).remove(),$("#dtspecificwshours").find("tbody").append(specificHtml),$("#location_ws_id_"+t).append(o)}))}))}});